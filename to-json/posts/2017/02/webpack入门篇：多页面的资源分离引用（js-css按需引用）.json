{"title":"webpack入门篇：多页面的资源分离引用（js/css按需引用）","slug":"webpack入门篇：多页面的资源分离引用（js-css按需引用）","updated":1487302839042,"link":"","permalink":"http://www.fedjs.com/2017/02/webpack入门篇：多页面的资源分离引用（js-css按需引用）/","path":"2017/02/webpack入门篇：多页面的资源分离引用（js-css按需引用）/","photos":[],"comments":true,"source":"_posts/webpack入门篇：多页面的资源分离引用（js-css按需引用）.md","published":true,"excerpt":"","content":"<h1 id=\"新建-index-html\"><a href=\"#新建-index-html\" class=\"headerlink\" title=\"新建 index.html:\"></a>新建 index.html:</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ vim ./src/tpl/index.html</div></pre></td></tr></table></figure>\n<h1 id=\"修改-webpack-config-js-配置文件\"><a href=\"#修改-webpack-config-js-配置文件\" class=\"headerlink\" title=\"修改 webpack.config.js 配置文件:\"></a>修改 webpack.config.js 配置文件:</h1><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">plugins:[</div><div class=\"line\">        <span class=\"keyword\">new</span> HtmlWebpackPlugin(&#123;</div><div class=\"line\">            <span class=\"attr\">filename</span>: __dirname+<span class=\"string\">'/build/html/login-build.html'</span>,</div><div class=\"line\">            <span class=\"attr\">template</span>:__dirname+<span class=\"string\">'/src/tpl/login.html'</span>,</div><div class=\"line\">            <span class=\"attr\">inject</span>:<span class=\"string\">'body'</span>,</div><div class=\"line\">            <span class=\"attr\">hash</span>:<span class=\"literal\">true</span></div><div class=\"line\">        &#125;),</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">new</span> HtmlWebpackPlugin(&#123;</div><div class=\"line\">            <span class=\"attr\">filename</span>: __dirname+<span class=\"string\">'/build/html/index-build.html'</span>,</div><div class=\"line\">            <span class=\"attr\">template</span>:__dirname+<span class=\"string\">'/src/tpl/index.html'</span>,</div><div class=\"line\">            <span class=\"attr\">inject</span>:<span class=\"string\">'body'</span>,</div><div class=\"line\">            <span class=\"attr\">hash</span>:<span class=\"literal\">true</span></div><div class=\"line\">        &#125;),</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">// 拆分插件</span></div><div class=\"line\">        <span class=\"keyword\">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</div><div class=\"line\">            <span class=\"attr\">name</span>:<span class=\"string\">'user'</span>, <span class=\"comment\">// 上面入口定义的节点组</span></div><div class=\"line\">            filename:<span class=\"string\">'build-user.js'</span> <span class=\"comment\">//最后生成的文件名</span></div><div class=\"line\">        &#125;),</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">// css抽取</span></div><div class=\"line\">        <span class=\"keyword\">new</span> extractTextPlugin(<span class=\"string\">\"[name].css\"</span>),</div><div class=\"line\">    ]</div></pre></td></tr></table></figure>\n<p>这样执行webpack命令后，生成的2个目标文件（index-build.html，login-build.html），有什么问题呢？</p>\n<p>2个文件都引入了所有的js和css。</p>\n<p><strong>下面我们要做到按需引用，不同的html模板引入仅它自己需要的css和js</strong></p>\n<ol>\n<li><p>为index.html新建一个index.css:</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-tag\">h1</span>&#123;<span class=\"attribute\">color</span>: green&#125;</div></pre></td></tr></table></figure>\n</li>\n<li><p>为index.html新建index.js，并在其中引入index.css:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">alert(<span class=\"string\">'这是首页'</span>);</div><div class=\"line\"><span class=\"built_in\">require</span>(<span class=\"string\">'./css/index.css'</span>);</div></pre></td></tr></table></figure>\n</li>\n<li><p>编辑webpack.config.js，为不同的html模板指定不同的配置节点</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> HtmlWebpackPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">'html-webpack-plugin'</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> webpack = <span class=\"built_in\">require</span>(<span class=\"string\">'webpack'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">var</span> extractTextPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">'extract-text-webpack-plugin'</span>);</div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</div><div class=\"line\">    <span class=\"comment\">// entry是入口文件，可以多个，代表要编译那些js</span></div><div class=\"line\">    <span class=\"comment\">//entry:['./src/main.js','./src/login.js','./src/reg.js'],</span></div><div class=\"line\"></div><div class=\"line\">    entry:</div><div class=\"line\">    &#123;</div><div class=\"line\">        <span class=\"string\">'main'</span>:<span class=\"string\">'./src/main.js'</span>,</div><div class=\"line\">        <span class=\"string\">'user'</span>:[<span class=\"string\">'./src/login.js'</span>,<span class=\"string\">'./src/reg.js'</span>],</div><div class=\"line\">        <span class=\"string\">'index'</span>:[<span class=\"string\">'./src/index.js'</span>]</div><div class=\"line\">    &#125;,</div><div class=\"line\"></div><div class=\"line\">    <span class=\"attr\">externals</span>:&#123;</div><div class=\"line\">        <span class=\"string\">'jquery'</span>:<span class=\"string\">'jQuery'</span></div><div class=\"line\">    &#125;,</div><div class=\"line\"></div><div class=\"line\">    <span class=\"attr\">module</span>:&#123;</div><div class=\"line\">        <span class=\"attr\">loaders</span>:[</div><div class=\"line\">            <span class=\"comment\">// &#123;test:/\\.css$/,loader:'style-loader!css-loader'&#125;,</span></div><div class=\"line\">            &#123;<span class=\"attr\">test</span>:<span class=\"regexp\">/\\.css$/</span>,<span class=\"attr\">loader</span>:extractTextPlugin.extract(<span class=\"string\">'style'</span>,<span class=\"string\">'css'</span>)&#125;</div><div class=\"line\">        ],</div><div class=\"line\">    &#125;,</div><div class=\"line\"></div><div class=\"line\">    <span class=\"attr\">output</span>:&#123;</div><div class=\"line\">        <span class=\"attr\">path</span>: __dirname+<span class=\"string\">'/build/js'</span>, <span class=\"comment\">// 输出到那个目录下（__dirname当前项目目录）</span></div><div class=\"line\">        filename:<span class=\"string\">'[name].js'</span> <span class=\"comment\">//最终打包生产的文件名</span></div><div class=\"line\">    &#125;,</div><div class=\"line\"></div><div class=\"line\">    <span class=\"attr\">plugins</span>:[</div><div class=\"line\">        <span class=\"keyword\">new</span> HtmlWebpackPlugin(&#123;</div><div class=\"line\">            <span class=\"attr\">filename</span>: __dirname+<span class=\"string\">'/build/html/login-build.html'</span>,</div><div class=\"line\">            <span class=\"attr\">template</span>:__dirname+<span class=\"string\">'/src/tpl/login.html'</span>,</div><div class=\"line\">            <span class=\"attr\">inject</span>:<span class=\"string\">'body'</span>,</div><div class=\"line\">            <span class=\"attr\">hash</span>:<span class=\"literal\">true</span>,</div><div class=\"line\">            <span class=\"attr\">chunks</span>:[<span class=\"string\">'main'</span>,<span class=\"string\">'user'</span>]   <span class=\"comment\">// 这个模板对应上面那个节点</span></div><div class=\"line\">        &#125;),</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">new</span> HtmlWebpackPlugin(&#123;</div><div class=\"line\">            <span class=\"attr\">filename</span>: __dirname+<span class=\"string\">'/build/html/index-build.html'</span>,</div><div class=\"line\">            <span class=\"attr\">template</span>:__dirname+<span class=\"string\">'/src/tpl/index.html'</span>,</div><div class=\"line\">            <span class=\"attr\">inject</span>:<span class=\"string\">'body'</span>,</div><div class=\"line\">            <span class=\"attr\">hash</span>:<span class=\"literal\">true</span>,</div><div class=\"line\">            <span class=\"attr\">chunks</span>:[<span class=\"string\">'index'</span>]   <span class=\"comment\">// 这个模板对应上面那个节点</span></div><div class=\"line\">        &#125;),</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">// css抽取</span></div><div class=\"line\">        <span class=\"keyword\">new</span> extractTextPlugin(<span class=\"string\">\"[name].css\"</span>),</div><div class=\"line\">    ]</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n</li>\n<li><p>执行webpack之后 </p>\n</li>\n</ol>\n<p><img src=\"http://img.blog.csdn.net/20160822210719754\" alt=\"展示图片\"></p>\n<p>查看index-build.html中只引入了index.css和index.js</p>","prev":{"title":"webpack入门篇：webpack-dev-server服务器","slug":"webpack入门篇：webpack-dev-server服务器","updated":1487318495621,"link":"","permalink":"http://www.fedjs.com/2017/02/webpack入门篇：webpack-dev-server服务器/","path":"2017/02/webpack入门篇：webpack-dev-server服务器/","photos":[],"comments":true,"source":"_posts/webpack入门篇：webpack-dev-server服务器.md","published":true},"next":{"title":"webpack插件篇：WebpackPluginGraphqlSchemaHot详解","slug":"webpack插件篇：WebpackPluginGraphqlSchemaHot详解","updated":1487319066595,"link":"","permalink":"http://www.fedjs.com/2017/02/webpack插件篇：WebpackPluginGraphqlSchemaHot详解/","path":"2017/02/webpack插件篇：WebpackPluginGraphqlSchemaHot详解/","photos":[],"comments":true,"source":"_posts/webpack插件篇：WebpackPluginGraphqlSchemaHot详解.md","published":true},"categories":[{"name":"webpack","slug":"webpack","path":"categories/webpack/","permalink":"http://www.fedjs.com/categories/webpack/","length":59}],"tags":[]}